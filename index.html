<!DOCTYPE HTML>
<html>
 <head>
  <script type="application/javascript" src="geohash.js"></script>
  <script type="application/javascript">
   var inputLat;
   var inputLat;
   var inputGeohash;
   var inputText;
   window.addEventListener('load', function(){
   	inputLat = document.getElementById('inputLat');
   	inputLon = document.getElementById('inputLon');
   	inputGeohash = document.getElementById('inputGeohash');
   	inputText = document.getElementById('inputText');
   	inputText.value = localStorage.getItem("text");
   } );
   
   function updateHash() {
   	inputGeohash.value = encodeGeoHash(inputLat.value, inputLon.value);
   }
   
   function updateCoords() {
   	navigator.geolocation.getCurrentPosition(function(pos){
   		console.log(pos);
   		inputLat.value = pos.coords.latitude;
   		inputLon.value = pos.coords.longitude;
   		updateHash();
   	} );
   }
   function updateStorage() {
   	localStorage.setItem("text", inputText.value);
   }
   
   function insertItem(){
   	inputText.value += '\n' + inputLabel.value + '\t' + inputGeohash.value;
   	updateStorage();
   }
   

  </script>
  <style type="text/css">
   input,textarea {
   	font-family: monospace;
   }
   textarea{
   	display: block;
   	margin: 0;
   	width: 100%;
   	min-width: 100%;
   	min-height: 20ex;
   	padding: 0;
   	border: 0;
   	background: #eee;
   }
   .textDiv {
   	border: 0.15em solid black;
   	padding: 0.15em;
   }
   div {
    margin-top: 0.3em;
   }
  </style>
 </head>
 <body>
  <fieldset>
   <div>
    Lat<input type="number" step="0.00000001" name="x" id="inputLat" onchange="updateHash()" size="15">°
    Lon<input type="number" step="0.00000001" name="y" id="inputLon" onchange="updateHash()" size="15">°
    GH<input type="text" size="12" readonly="readonly" id="inputGeohash">
    <button type="button" onclick="updateCoords()">Obter</button>
   </div>
   <div>
    <input id="inputLabel"><button type="button" onclick="insertItem()">Inserir</button>
   </div>
  </fieldset>
  <div class="textDiv">
  <textarea id="inputText" onchange="updateStorage()"></textarea>
  </div>
 </body>
</html>
